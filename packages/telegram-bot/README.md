# @selectio/telegram-bot

Telegram бот на базе Grammy для общения с кандидатами.

## Возможности

- Отправка сообщений кандидатам
- Прием ответов от кандидатов
- Сохранение всех сообщений в базе данных
- Отслеживание статуса диалогов

## Установка

```bash
bun install
```

## Настройка

Добавьте в `.env`:

```
TELEGRAM_BOT_TOKEN=your_bot_token_here
```

## Запуск

```bash
bun run dev
```

## Использование

### Отправка сообщения

```typescript
import { sendMessage } from "@selectio/telegram-bot";

// От бота
await sendMessage("chat_id", "Привет! Как дела?");

// От админа
await sendMessage("chat_id", "Здравствуйте, я HR менеджер", "ADMIN");
```

## База данных

Бот использует две таблицы:

- `telegram_conversations` - диалоги с кандидатами
- `telegram_messages` - все сообщения с указанием отправителя (CANDIDATE, BOT, ADMIN) и типа контента (TEXT, VOICE)

## Голосовые сообщения

Голосовые сообщения от кандидатов автоматически загружаются в хранилище и сохраняются в таблице `files`.

## Хранилище файлов

Файлы хранятся в S3-совместимом хранилище. URL генерируется динамически на основе ключа, что позволяет менять домен без миграции данных.

Используйте `getFileUrl(key)` из `@selectio/lib` для получения актуального URL файла.
